### 布隆过滤器
#### 用位图来方便查找是否存在
假设要查找一个用户ID是否已经注册过, 或者其他的查询是否存在的需求，用位图空间换时间的方式一种常见的方案。
将要查找的内容转成一个整数n，通过查找bitmap的第n位是否为1排判断是否存在。

![bitmap](https://github.com/checkking/notes/blob/master/imgs/bitmap.png)

假设用char数组来实现bitmap, 一个char占8个bit, 判断n是否在bitmap中，可以先找到在数据的第几个位置和具体的第几个位。具体实现见golang代码.

#### 用布隆过滤器来节省存储空间
布隆过滤器最大的特点，就是对一个对象使用多个哈希函数。如果我们使用了 k 个哈希函数，就会得到 k 个哈希值，也就是 k 个下标，我们会把数组中对应下标位置的值都置为 1。布隆过滤器和位图最大的区别就在于，我们不再使用一位来表示一个对象，而是使用 k 位来表示一个对象。这样两个对象的 k 位都相同的概率就会大大降低，从而能够解决哈希冲突的问题了。

![bloomfilter](https://github.com/checkking/notes/blob/master/imgs/bloomfilter.png)

bloomfilter存在假正的问题(False Positive)， 也就是不存在一定是真的，判断存在不一定是真的。这个错误率是受位图大小、元素个数和hash函数个数影响的。

计算最优哈希函数个数的数学公式: 哈希函数个数 k = (m/n) * ln(2)。其中 m 为 bit 数组长度，n 为要存入的对象的个数。实际上，如果哈希函数个数为 1，且数组长度足够，布隆过滤器就可以退化成一个位图。
